"""

Sanity check for electron scattering factor implementations. The tabulated
values don't account for the relativistic correction nor include Debye Waller
Factors, so the actual values used in computations will be different. Also the
fit of WK and LVD was not necessarily for this exact tablation from: 

https://onlinelibrary.wiley.com/iucr/itc/Cb/ch4o3v0001/ch4o3.pdf

Assumed errata in the table for Cobalt with s=0.30: f = 2.471 not 1.471.

"""

import torch
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from typing import List, Tuple

# Assuming the provided code is imported as:
from scattering_factors_WK import scatter_factor_WK
from scattering_factors_LVD_TCB import scatter_factor_LVD
from scattering_factors_Hybrid import scatter_factor_hybrid

# Hydrogen not included
# fmt: off

# https://onlinelibrary.wiley.com/iucr/itc/Cb/ch4o3v0001/ch4o3.pdf
pg_263 = [
0.00, 0.418, 3.286, 3.052, 2.794, 2.509, 2.211, 1.983, 1.801, 1.652, 4.778, 
0.01, 0.418, 3.265, 3.042, 2.788, 2.505, 2.209, 1.982, 1.800, 1.651, 4.749, 
0.02, 0.417, 3.200, 3.011, 2.768, 2.492, 2.201, 1.976, 1.796, 1.648, 4.663, 
0.03, 0.415, 3.097, 2.961, 2.736, 2.471, 2.187, 1.966, 1.789, 1.642, 4.527, 
0.04, 0.413, 2.961, 2.892, 2.693, 2.442, 2.168, 1.953, 1.779, 1.635, 4.348, 
0.05, 0.410, 2.800, 2.807, 2.638, 2.406, 2.144, 1.937, 1.767, 1.626, 4.138, 
0.06, 0.407, 2.622, 2.710, 2.574, 2.363, 2.116, 1.917, 1.752, 1.615, 3.908, 
0.07, 0.404, 2.435, 2.601, 2.502, 2.313, 2.083, 1.893, 1.735, 1.602, 3.667, 
0.08, 0.399, 2.245, 2.484, 2.423, 2.259, 2.047, 1.867, 1.716, 1.587, 3.425, 
0.09, 0.395, 2.058, 2.362, 2.339, 2.200, 2.007, 1.839, 1.694, 1.570, 3.190, 
0.10, 0.390, 1.879, 2.237, 2.250, 2.138, 1.963, 1.808, 1.671, 1.552, 2.967, 
0.11, 0.384, 1.710, 2.111, 2.159, 2.072, 1.918, 1.774, 1.646, 1.533, 2.759, 
0.12, 0.378, 1.554, 1.987, 2.067, 2.005, 1.870, 1.739, 1.619, 1.512, 2.569, 
0.13, 0.372, 1.411, 1.865, 1.974, 1.936, 1.821, 1.702, 1.591, 1.490, 2.395, 
0.14, 0.366, 1.282, 1.748, 1.882, 1.866, 1.770, 1.664, 1.562, 1.467, 2.239, 
0.15, 0.359, 1.166, 1.635, 1.791, 1.796, 1.718, 1.625, 1.532, 1.443, 2.099, 
0.16, 0.352, 1.063, 1.528, 1.702, 1.727, 1.666, 1.585, 1.501, 1.418, 1.974, 
0.17, 0.345, 0.971, 1.427, 1.616, 1.658, 1.614, 1.545, 1.469, 1.393, 1.863, 
0.18, 0.338, 0.889, 1.332, 1.533, 1.591, 1.561, 1.504, 1.436, 1.367, 1.763, 
0.19, 0.330, 0.817, 1.243, 1.453, 1.524, 1.510, 1.463, 1.404, 1.340, 1.674, 
0.20, 0.323, 0.753, 1.161, 1.377, 1.460, 1.458, 1.422, 1.371, 1.313, 1.594, 
0.22, 0.308, 0.646, 1.013, 1.235, 1.337, 1.358, 1.341, 1.304, 1.259, 1.458, 
0.24, 0.293, 0.562, 0.887, 1.107, 1.222, 1.262, 1.261, 1.238, 1.204, 1.344, 
0.25, 0.286, 0.526, 0.832, 1.048, 1.168, 1.216, 1.222, 1.206, 1.176, 1.295, 
0.26, 0.278, 0.494, 0.781, 0.993, 1.117, 1.171, 1.184, 1.173, 1.149, 1.249, 
0.28, 0.264, 0.440, 0.690, 0.892, 1.020, 1.085, 1.110, 1.110, 1.095, 1.167, 
0.30, 0.250, 0.396, 0.614, 0.803, 0.932, 1.006, 1.040, 1.049, 1.043, 1.095, 
0.32, 0.236, 0.359, 0.549, 0.725, 0.853, 0.932, 0.974, 0.991, 0.991, 1.031, 
0.34, 0.224, 0.328, 0.494, 0.657, 0.781, 0.863, 0.911, 0.935, 0.942, 0.973, 
0.35, 0.217, 0.314, 0.469, 0.625, 0.748, 0.831, 0.881, 0.908, 0.918, 0.946, 
0.36, 0.211, 0.301, 0.446, 0.596, 0.717, 0.800, 0.853, 0.882, 0.894, 0.921, 
0.38, 0.200, 0.279, 0.406, 0.543, 0.658, 0.742, 0.798, 0.831, 0.849, 0.872, 
0.40, 0.189, 0.259, 0.371, 0.497, 0.606, 0.689, 0.747, 0.784, 0.805, 0.827, 
0.42, 0.178, 0.241, 0.341, 0.455, 0.559, 0.641, 0.700, 0.739, 0.764, 0.785, 
0.44, 0.169, 0.226, 0.314, 0.419, 0.517, 0.596, 0.656, 0.697, 0.725, 0.746, 
0.45, 0.164, 0.219, 0.302, 0.402, 0.497, 0.575, 0.635, 0.677, 0.706, 0.727, 
0.46, 0.159, 0.212, 0.291, 0.387, 0.479, 0.555, 0.615, 0.658, 0.687, 0.709, 
0.48, 0.151, 0.200, 0.271, 0.358, 0.444, 0.518, 0.577, 0.621, 0.652, 0.675, 
0.50, 0.143, 0.188, 0.253, 0.333, 0.413, 0.484, 0.542, 0.586, 0.619, 0.642, 
0.55, 0.125, 0.164, 0.215, 0.280, 0.348, 0.411, 0.466, 0.510, 0.544, 0.569, 
0.60, 0.110, 0.145, 0.186, 0.239, 0.297, 0.353, 0.403, 0.445, 0.479, 0.505, 
0.65, 0.097, 0.128, 0.164, 0.207, 0.256, 0.305, 0.350, 0.390, 0.424, 0.450, 
0.70, 0.086, 0.115, 0.145, 0.182, 0.223, 0.266, 0.307, 0.344, 0.376, 0.403, 
0.80, 0.068, 0.093, 0.117, 0.144, 0.175, 0.208, 0.241, 0.272, 0.300, 0.325, 
0.90, 0.055, 0.077, 0.096, 0.118, 0.141, 0.167, 0.193, 0.219, 0.244, 0.266, 
1.00, 0.046, 0.064, 0.081, 0.098, 0.117, 0.137, 0.159, 0.180, 0.201, 0.221, 
1.10, 0.038, 0.054, 0.069, 0.083, 0.099, 0.115, 0.133, 0.150, 0.168, 0.185, 
1.20, 0.032, 0.046, 0.059, 0.072, 0.085, 0.098, 0.113, 0.128, 0.143, 0.158, 
1.30, 0.028, 0.040, 0.051, 0.062, 0.073, 0.085, 0.097, 0.110, 0.123, 0.135, 
1.40, 0.024, 0.035, 0.045, 0.055, 0.064, 0.074, 0.085, 0.095, 0.106, 0.117, 
1.50, 0.021, 0.031, 0.040, 0.048, 0.057, 0.065, 0.074, 0.084, 0.093, 0.103, 
1.60, 0.019, 0.028, 0.035, 0.043, 0.051, 0.058, 0.066, 0.074, 0.083, 0.092, 
1.70, 0.016, 0.024, 0.031, 0.038, 0.045, 0.052, 0.059, 0.066, 0.074, 0.081, 
1.80, 0.015, 0.022, 0.028, 0.035, 0.041, 0.047, 0.053, 0.060, 0.066, 0.073, 
1.90, 0.013, 0.019, 0.026, 0.031, 0.037, 0.043, 0.048, 0.054, 0.060, 0.065, 
2.00, 0.012, 0.017, 0.023, 0.028, 0.034, 0.039, 0.044, 0.049, 0.054, 0.059,
]

pg_264 = [
0.00, 5.207, 5.889, 5.828, 5.488, 5.161, 4.857, 4.580, 8.984, 9.913, 9.307, 8.776, 
0.01, 5.187, 5.867, 5.810, 5.476, 5.152, 4.851, 4.576, 8.921, 9.860, 9.264, 8.740, 
0.02, 5.124, 5.800, 5.759, 5.439, 5.124, 4.830, 4.559, 8.731, 9.699, 9.134, 8.631, 
0.03, 5.022, 5.692, 5.675, 5.378, 5.079, 4.795, 4.531, 8.434, 9.442, 8.926, 8.455, 
0.04, 4.884, 5.547, 5.561, 5.296, 5.016, 4.746, 4.493, 8.054, 9.104, 8.649, 8.220, 
0.05, 4.717, 5.371, 5.421, 5.192, 4.938, 4.685, 4.444, 7.619, 8.703, 8.318, 7.937, 
0.06, 4.527, 5.170, 5.258, 5.071, 4.845, 4.613, 4.386, 7.157, 8.258, 7.946, 7.618, 
0.07, 4.320, 4.949, 5.077, 4.935, 4.740, 4.529, 4.320, 6.691, 7.789, 7.548, 7.274, 
0.08, 4.102, 4.717, 4.882, 4.785, 4.623, 4.436, 4.245, 6.239, 7.312, 7.139, 6.917, 
0.09, 3.879, 4.478, 4.677, 4.625, 4.496, 4.335, 4.163, 5.815, 6.841, 6.729, 6.556, 
0.10, 3.656, 4.237, 4.467, 4.457, 4.362, 4.227, 4.074, 5.426, 6.388, 6.328, 6.199, 
0.11, 3.437, 3.999, 4.255, 4.285, 4.222, 4.113, 3.980, 5.073, 5.959, 5.944, 5.853, 
0.12, 3.226, 3.767, 4.043, 4.109, 4.078, 3.994, 3.881, 4.756, 5.560, 5.580, 5.522, 
0.13, 3.025, 3.544, 3.835, 3.933, 3.931, 3.871, 3.779, 4.474, 5.192, 5.239, 5.209, 
0.14, 2.835, 3.330, 3.632, 3.758, 3.783, 3.746, 3.674, 4.222, 4.855, 4.924, 4.916, 
0.15, 2.657, 3.128, 3.437, 3.586, 3.635, 3.620, 3.566, 3.997, 4.550, 4.633, 4.643, 
0.16, 2.492, 2.938, 3.249, 3.417, 3.487, 3.493, 3.458, 3.795, 4.273, 4.366, 4.390, 
0.17, 2.340, 2.760, 3.070, 3.253, 3.342, 3.367, 3.348, 3.612, 4.023, 4.122, 4.157, 
0.18, 2.199, 2.595, 2.900, 3.094, 3.200, 3.242, 3.239, 3.446, 3.797, 3.899, 3.943, 
0.19, 2.071, 2.441, 2.740, 2.942, 3.061, 3.118, 3.130, 3.295, 3.593, 3.695, 3.745, 
0.20, 1.953, 2.299, 2.589, 2.796, 2.927, 2.997, 3.022, 3.154, 3.408, 3.509, 3.564, 
0.22, 1.748, 2.046, 2.315, 2.525, 2.671, 2.763, 2.811, 2.902, 3.086, 3.183, 3.242, 
0.24, 1.577, 1.832, 2.076, 2.281, 2.436, 2.543, 2.609, 2.680, 2.815, 2.906, 2.967, 
0.25, 1.502, 1.737, 1.969, 2.169, 2.326, 2.438, 2.512, 2.578, 2.695, 2.783, 2.844, 
0.26, 1.434, 1.650, 1.869, 2.064, 2.221, 2.337, 2.417, 2.481, 2.584, 2.669, 2.730, 
0.28, 1.313, 1.495, 1.689, 1.872, 2.026, 2.148, 2.238, 2.299, 2.383, 2.462, 2.523, 
0.30, 1.211, 1.363, 1.534, 1.702, 1.851, 1.974, 2.070, 2.134, 2.206, 2.281, 2.341, 
0.32, 1.123, 1.251, 1.400, 1.553, 1.694, 1.816, 1.915, 1.982, 2.048, 2.119, 2.178, 
0.34, 1.047, 1.154, 1.284, 1.422, 1.554, 1.672, 1.772, 1.842, 1.905, 1.974, 2.032, 
0.35, 1.013, 1.111, 1.231, 1.362, 1.490, 1.606, 1.705, 1.776, 1.838, 1.906, 1.964, 
0.36, 0.980, 1.070, 1.182, 1.306, 1.429, 1.542, 1.641, 1.714, 1.775, 1.842, 1.899, 
0.38, 0.921, 0.997, 1.094, 1.205, 1.318, 1.425, 1.522, 1.595, 1.657, 1.722, 1.778, 
0.40, 0.868, 0.932, 1.017, 1.115, 1.218, 1.319, 1.412, 1.487, 1.548, 1.612, 1.668, 
0.42, 0.821, 0.875, 0.949, 1.036, 1.130, 1.224, 1.313, 1.387, 1.449, 1.511, 1.566, 
0.44, 0.777, 0.825, 0.888, 0.965, 1.051, 1.138, 1.223, 1.295, 1.357, 1.418, 1.472, 
0.45, 0.757, 0.801, 0.861, 0.933, 1.014, 1.098, 1.181, 1.252, 1.314, 1.374, 1.428, 
0.46, 0.738, 0.779, 0.834, 0.903, 0.980, 1.061, 1.141, 1.211, 1.272, 1.332, 1.385, 
0.48, 0.701, 0.737, 0.786, 0.847, 0.917, 0.991, 1.066, 1.134, 1.194, 1.252, 1.305, 
0.50, 0.667, 0.700, 0.743, 0.797, 0.860, 0.928, 0.998, 1.064, 1.123, 1.179, 1.230, 
0.55, 0.592, 0.618, 0.651, 0.692, 0.741, 0.796, 0.854, 0.912, 0.966, 1.018, 1.067, 
0.60, 0.528, 0.551, 0.578, 0.610, 0.648, 0.692, 0.740, 0.790, 0.838, 0.885, 0.930, 
0.65, 0.473, 0.494, 0.517, 0.543, 0.573, 0.609, 0.648, 0.690, 0.733, 0.775, 0.816, 
0.70, 0.425, 0.445, 0.465, 0.487, 0.513, 0.541, 0.574, 0.609, 0.647, 0.684, 0.721, 
0.80, 0.347, 0.366, 0.383, 0.401, 0.419, 0.440, 0.462, 0.488, 0.515, 0.544, 0.573, 
0.90, 0.286, 0.304, 0.320, 0.335, 0.350, 0.366, 0.383, 0.402, 0.422, 0.444, 0.467, 
1.00, 0.239, 0.255, 0.270, 0.284, 0.298, 0.311, 0.324, 0.339, 0.354, 0.371, 0.389, 
1.10, 0.202, 0.217, 0.231, 0.243, 0.255, 0.267, 0.278, 0.290, 0.303, 0.316, 0.330, 
1.20, 0.172, 0.185, 0.198, 0.210, 0.221, 0.232, 0.242, 0.252, 0.262, 0.273, 0.285, 
1.30, 0.148, 0.160, 0.172, 0.183, 0.193, 0.202, 0.212, 0.220, 0.230, 0.239, 0.249, 
1.40, 0.129, 0.139, 0.150, 0.160, 0.169, 0.178, 0.187, 0.194, 0.202, 0.211, 0.219, 
1.50, 0.113, 0.123, 0.132, 0.141, 0.150, 0.158, 0.166, 0.174, 0.181, 0.188, 0.195, 
1.60, 0.100, 0.109, 0.117, 0.125, 0.133, 0.141, 0.148, 0.156, 0.162, 0.169, 0.175, 
1.70, 0.089, 0.096, 0.104, 0.111, 0.119, 0.126, 0.132, 0.138, 0.144, 0.151, 0.157, 
1.80, 0.080, 0.087, 0.093, 0.100, 0.107, 0.113, 0.119, 0.127, 0.132, 0.137, 0.143, 
1.90, 0.072, 0.078, 0.084, 0.090, 0.096, 0.102, 0.108, 0.112, 0.118, 0.124, 0.129, 
2.00, 0.065, 0.070, 0.076, 0.082, 0.087, 0.093, 0.098, 0.101, 0.107, 0.112, 0.117
]

pg_265 = [
0.00, 8.305, 6.969, 7.506, 7.165, 6.854, 6.569, 5.600, 6.065, 7.108, 7.378, 7.320, 
0.01, 8.274, 6.945, 7.484, 7.145, 6.836, 6.552, 5.587, 6.051, 7.088, 7.359, 7.306, 
0.02, 8.180, 6.875, 7.412, 7.081, 6.779, 6.501, 5.547, 6.009, 7.027, 7.303, 7.260, 
0.03, 8.029, 6.762, 7.296, 6.978, 6.687, 6.418, 5.482, 5.941, 6.927, 7.211, 7.184, 
0.04, 7.826, 6.610, 7.140, 6.839, 6.562, 6.306, 5.395, 5.849, 6.792, 7.088, 7.081, 
0.05, 7.581, 6.427, 6.949, 6.669, 6.410, 6.169, 5.287, 5.735, 6.629, 6.935, 6.953, 
0.06, 7.303, 6.221, 6.732, 6.474, 6.234, 6.010, 5.165, 5.603, 6.441, 6.759, 6.803, 
0.07, 7.002, 5.997, 6.493, 6.260, 6.040, 5.834, 5.029, 5.457, 6.236, 6.562, 6.634, 
0.08, 6.686, 5.764, 6.241, 6.032, 5.834, 5.646, 4.886, 5.299, 6.017, 6.351, 6.449, 
0.09, 6.365, 5.527, 5.981, 5.796, 5.619, 5.449, 4.737, 5.133, 5.792, 6.129, 6.253, 
0.10, 6.045, 5.291, 5.719, 5.558, 5.401, 5.249, 4.585, 4.962, 5.564, 5.902, 6.048, 
0.11, 5.732, 5.061, 5.459, 5.320, 5.182, 5.048, 4.434, 4.790, 5.337, 5.672, 5.838, 
0.12, 5.430, 4.838, 5.206, 5.087, 4.967, 4.848, 4.285, 4.618, 5.113, 5.442, 5.625, 
0.13, 5.142, 4.625, 4.962, 4.861, 4.758, 4.654, 4.139, 4.449, 4.896, 5.217, 5.411, 
0.14, 4.871, 4.423, 4.728, 4.644, 4.555, 4.465, 3.998, 4.283, 4.686, 4.996, 5.200, 
0.15, 4.616, 4.231, 4.506, 4.436, 4.361, 4.283, 3.862, 4.123, 4.486, 4.783, 4.992, 
0.16, 4.378, 4.051, 4.297, 4.240, 4.177, 4.110, 3.731, 3.969, 4.295, 4.578, 4.789, 
0.17, 4.158, 3.882, 4.100, 4.054, 4.002, 3.944, 3.607, 3.822, 4.114, 4.382, 4.593, 
0.18, 3.953, 3.723, 3.916, 3.880, 3.836, 3.788, 3.488, 3.681, 3.942, 4.195, 4.404, 
0.19, 3.763, 3.574, 3.743, 3.716, 3.681, 3.640, 3.375, 3.547, 3.781, 4.017, 4.222, 
0.20, 3.588, 3.434, 3.583, 3.562, 3.534, 3.500, 3.267, 3.421, 3.629, 3.849, 4.048, 
0.22, 3.276, 3.179, 3.292, 3.284, 3.267, 3.245, 3.067, 3.186, 3.352, 3.541, 3.724, 
0.24, 3.006, 2.953, 3.039, 3.039, 3.032, 3.018, 2.885, 2.977, 3.108, 3.268, 3.433, 
0.25, 2.885, 2.849, 2.924, 2.928, 2.924, 2.914, 2.800, 2.880, 2.997, 3.143, 3.299, 
0.26, 2.772, 2.750, 2.817, 2.824, 2.823, 2.816, 2.719, 2.789, 2.892, 3.026, 3.172, 
0.28, 2.568, 2.568, 2.620, 2.632, 2.637, 2.636, 2.568, 2.620, 2.701, 2.813, 2.940, 
0.30, 2.386, 2.403, 2.445, 2.461, 2.471, 2.474, 2.428, 2.468, 2.531, 2.623, 2.733, 
0.32, 2.225, 2.252, 2.288, 2.308, 2.321, 2.328, 2.299, 2.329, 2.379, 2.455, 2.548, 
0.34, 2.079, 2.114, 2.146, 2.168, 2.184, 2.195, 2.180, 2.203, 2.242, 2.304, 2.384, 
0.35, 2.011, 2.049, 2.080, 2.104, 2.121, 2.133, 2.123, 2.144, 2.179, 2.235, 2.308, 
0.36, 1.947, 1.987, 2.017, 2.042, 2.060, 2.073, 2.069, 2.087, 2.119, 2.169, 2.237, 
0.38, 1.826, 1.870, 1.899, 1.925, 1.946, 1.962, 1.965, 1.980, 2.006, 2.048, 2.105, 
0.40, 1.716, 1.761, 1.790, 1.818, 1.841, 1.858, 1.868, 1.882, 1.903, 1.938, 1.986, 
0.42, 1.614, 1.660, 1.690, 1.719, 1.743, 1.763, 1.777, 1.790, 1.808, 1.837, 1.878, 
0.44, 1.520, 1.567, 1.597, 1.628, 1.653, 1.674, 1.691, 1.704, 1.720, 1.745, 1.780, 
0.45, 1.476, 1.523, 1.553, 1.584, 1.610, 1.631, 1.651, 1.663, 1.679, 1.702, 1.734, 
0.46, 1.433, 1.480, 1.511, 1.542, 1.569, 1.591, 1.611, 1.624, 1.639, 1.661, 1.691, 
0.48, 1.352, 1.399, 1.431, 1.462, 1.490, 1.513, 1.535, 1.549, 1.563, 1.583, 1.608, 
0.50, 1.277, 1.323, 1.356, 1.388, 1.416, 1.440, 1.464, 1.478, 1.492, 1.510, 1.533, 
0.55, 1.111, 1.155, 1.189, 1.222, 1.251, 1.277, 1.303, 1.319, 1.334, 1.349, 1.367, 
0.60, 0.973, 1.014, 1.047, 1.080, 1.110, 1.136, 1.163, 1.181, 1.197, 1.212, 1.228, 
0.65, 0.856, 0.894, 0.927, 0.959, 0.988, 1.015, 1.041, 1.061, 1.078, 1.093, 1.108, 
0.70, 0.757, 0.792, 0.824, 0.854, 0.883, 0.909, 0.935, 0.955, 0.973, 0.989, 1.004, 
0.80, 0.602, 0.631, 0.659, 0.686, 0.712, 0.737, 0.761, 0.781, 0.800, 0.817, 0.832, 
0.90, 0.490, 0.514, 0.538, 0.561, 0.583, 0.605, 0.626, 0.646, 0.665, 0.681, 0.697, 
1.00, 0.408, 0.427, 0.446, 0.466, 0.485, 0.504, 0.523, 0.541, 0.558, 0.574, 0.589, 
1.10, 0.345, 0.361, 0.377, 0.393, 0.409, 0.425, 0.442, 0.457, 0.473, 0.488, 0.502, 
1.20, 0.297, 0.310, 0.323, 0.336, 0.350, 0.364, 0.378, 0.391, 0.405, 0.418, 0.431, 
1.30, 0.259, 0.269, 0.280, 0.291, 0.303, 0.315, 0.327, 0.339, 0.350, 0.362, 0.374, 
1.40, 0.228, 0.237, 0.246, 0.255, 0.265, 0.275, 0.285, 0.296, 0.306, 0.317, 0.327, 
1.50, 0.203, 0.210, 0.218, 0.226, 0.235, 0.243, 0.252, 0.261, 0.270, 0.279, 0.288, 
1.60, 0.182, 0.188, 0.195, 0.202, 0.209, 0.217, 0.224, 0.232, 0.240, 0.248, 0.256, 
1.70, 0.163, 0.169, 0.175, 0.181, 0.188, 0.194, 0.201, 0.208, 0.215, 0.222, 0.229, 
1.80, 0.148, 0.154, 0.159, 0.165, 0.170, 0.176, 0.182, 0.188, 0.194, 0.200, 0.206, 
1.90, 0.134, 0.139, 0.144, 0.149, 0.154, 0.160, 0.165, 0.170, 0.175, 0.181, 0.187, 
2.00, 0.122, 0.127, 0.132, 0.136, 0.141, 0.146, 0.150, 0.155, 0.160, 0.165, 0.170
]

# fmt: on

if __name__ == "__main__":
    vals0 = np.array(pg_263).reshape(-1, 11)
    vals2 = np.array(pg_264).reshape(-1, 12)
    vals3 = np.array(pg_265).reshape(-1, 12)
    s_vals_plot = vals0[:, 0]
    f_vals1 = vals0[:, 1:]
    f_vals2 = vals2[:, 1:]
    f_vals3 = vals3[:, 1:]
    f_vals = np.concatenate(
        [
            f_vals1,
            f_vals2,
            f_vals3,
        ],
        axis=1,
    )
    z_vals = np.arange(2, 34)

    s_vals = torch.linspace(0.0, 2.0, 500)
    f_vals = torch.tensor(f_vals)
    z_vals = torch.tensor(z_vals)
    sigmas = torch.zeros_like(z_vals).float()
    voltage = 0.0  # doesn't matter for this calculation

    f_wk = scatter_factor_WK(
        g=s_vals * 2.0,
        Z=z_vals,
        thermal_sigma=sigmas,
        voltage_kV=voltage,
        include_core=False,
        include_phonon=False,
        return_type="ITC",
    )[0]

    f_lvd = scatter_factor_LVD(
        g=s_vals * 2.0,
        Z=z_vals,
        thermal_sigma=sigmas,
        voltage_kV=voltage,
        return_type="ITC",
        intervals=10,
    )[0]

    # this should be identical to the LVD calculation
    # for the real part of the scattering factor
    f_hyb = scatter_factor_hybrid(
        g=s_vals * 2.0,
        Z=z_vals,
        thermal_sigma=sigmas,
        voltage_kV=voltage,
        include_core=False,
        include_phonon=False,
        return_type="ITC",
    )[0]

    print(f"WK shape: {f_wk.shape}")
    print(f"LVD shape: {f_lvd.shape}")

    plt.figure(figsize=(15, 6))

    colors = sns.color_palette("husl", len(z_vals))

    for i, (z, color) in enumerate(zip(z_vals, colors)):
        plt.plot(
            s_vals.numpy(),
            f_wk[i].real.numpy(),
            label=f"Z={z} (WK)",
            color=color,
            linestyle="solid",
        )
        plt.plot(
            s_vals.numpy(),
            f_lvd[i].real.numpy(),
            label=f"Z={z} (LVD)",
            color=color,
            linestyle="dashdot",
        )
        plt.plot(
            s_vals.numpy(),
            f_hyb[i].real.numpy(),
            label=f"Z={z} (Hybrid)",
            color=color,
            linestyle="dashed",
        )

        plt.plot(
            s_vals_plot,
            f_vals[:, i],
            color="black",
            linestyle="dashed",
        )

    plt.xlabel("s (Å⁻¹)")
    plt.ylabel("f(s)")
    plt.yscale("log")
    # plt.legend()
    plt.show()
